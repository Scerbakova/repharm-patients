{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/patients.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nfunction RegistrationFormComponent_div_0_div_6_small_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 19);\n    i0.ɵɵtext(1, \" This field is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RegistrationFormComponent_div_0_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"label\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"input\", 18);\n    i0.ɵɵtemplate(4, RegistrationFormComponent_div_0_div_6_small_4_Template, 2, 0, \"small\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const field_r3 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    let tmp_5_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"for\", field_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(field_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"id\", field_r3)(\"formControlName\", field_r3)(\"placeholder\", field_r3 === \"date of birth\" ? \"DD.MM.YYYY\" : \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = ctx_r1.registerPatientForm.get(field_r3)) == null ? null : tmp_5_0.hasError(\"required\")) && ((tmp_5_0 = ctx_r1.registerPatientForm.get(field_r3)) == null ? null : tmp_5_0.touched));\n  }\n}\nfunction RegistrationFormComponent_div_0_small_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 19);\n    i0.ɵɵtext(1, \" This field is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RegistrationFormComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵlistener(\"click\", function RegistrationFormComponent_div_0_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.close());\n    });\n    i0.ɵɵelementStart(1, \"div\", 2);\n    i0.ɵɵlistener(\"click\", function RegistrationFormComponent_div_0_Template_div_click_1_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.preventClose($event));\n    });\n    i0.ɵɵelementStart(2, \"h2\", 3);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"form\", 4);\n    i0.ɵɵlistener(\"ngSubmit\", function RegistrationFormComponent_div_0_Template_form_ngSubmit_4_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.registerPatient());\n    });\n    i0.ɵɵelementStart(5, \"div\", 5);\n    i0.ɵɵtemplate(6, RegistrationFormComponent_div_0_div_6_Template, 5, 6, \"div\", 6);\n    i0.ɵɵelementStart(7, \"div\", 7)(8, \"label\", 8);\n    i0.ɵɵtext(9, \"Date of Birth\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"input\", 9);\n    i0.ɵɵtemplate(11, RegistrationFormComponent_div_0_small_11_Template, 2, 0, \"small\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 11)(13, \"label\", 12);\n    i0.ɵɵtext(14, \"Insurance\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"input\", 13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 14)(17, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function RegistrationFormComponent_div_0_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.close());\n    });\n    i0.ɵɵtext(18, \" Close \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"button\", 16);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_4_0;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.formTitle);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.registerPatientForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.patientFields);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formControlName\", \"date of birth\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_4_0 = ctx_r0.registerPatientForm.get(\"date of birth\")) == null ? null : tmp_4_0.hasError(\"required\")) && ((tmp_4_0 = ctx_r0.registerPatientForm.get(\"date of birth\")) == null ? null : tmp_4_0.touched));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formControlName\", \"insurance\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.registerOrEdit, \" \");\n  }\n}\nexport class RegistrationFormComponent {\n  personalIdValidator() {\n    return control => {\n      const personalId = control.value;\n      if (!personalId) {\n        return null;\n      }\n      const regex = /^\\d{6}-\\d{5}$/;\n      if (!regex.test(personalId)) {\n        return {\n          invalidPersonalId: true\n        };\n      }\n      return null;\n    };\n  }\n  buidForm() {\n    this.registerPatientForm = this.fb.group({\n      'first name': ['', Validators.required],\n      'last name': ['', Validators.required],\n      'personal id': ['', [Validators.required, this.personalIdValidator()]],\n      'date of birth': ['', [Validators.required, Validators.pattern(/^\\d{4}-\\d{2}-\\d{2}$/)]],\n      'phone number': ['', Validators.required, V],\n      email: ['', [Validators.required, Validators.email]],\n      'medical conditions': [''],\n      'surgical history': [''],\n      medications: [''],\n      allergies: [''],\n      immunizations: [''],\n      \"doctor's name\": ['', Validators.required],\n      \"doctor's surname\": ['', Validators.required],\n      insurance: [false]\n    });\n  }\n  populateForm() {\n    if (this.patient) {\n      this.registerPatientForm.patchValue({\n        'first name': this.patient.firstName,\n        'last name': this.patient.lastName,\n        'personal id': this.patient.personalId,\n        'date of birth': this.patient.dateOfBirth,\n        'phone number': this.patient.phoneNumber,\n        email: this.patient.email,\n        'medical conditions': this.patient.medicalConditions,\n        'surgical history': this.patient.surgicalHistory,\n        medications: this.patient.medications,\n        allergies: this.patient.allergies,\n        immunizations: this.patient.immunizations,\n        \"doctor's name\": this.patient.doctorsName,\n        \"doctor's surname\": this.patient.doctorsSurname,\n        insurance: this.patient.insurance\n      });\n    }\n  }\n  ngOnChanges(changes) {\n    if (changes.isModalOpen && this.isModalOpen) {\n      if (this.patient) {\n        this.populateForm();\n        this.registerOrEdit = 'Edit';\n        this.formTitle = \"Change Patient's data\";\n      } else {\n        this.registerOrEdit = 'Register';\n        this.formTitle = 'Register New Patient';\n        this.buidForm();\n      }\n    }\n  }\n  ngOnInit() {\n    this.buidForm();\n  }\n  close() {\n    this.resetForm();\n    this.isModalOpenChange.emit(false);\n  }\n  preventClose(event) {\n    event.stopPropagation();\n  }\n  resetForm() {\n    this.registerPatientForm.reset();\n  }\n  constructor(patientsService, fb) {\n    this.patientsService = patientsService;\n    this.fb = fb;\n    this.isModalOpen = false;\n    this.isModalOpenChange = new EventEmitter();\n    this.patientEdited = new EventEmitter();\n    this.registerPatientForm = this.fb.group({});\n    this.registerOrEdit = 'Register';\n    this.formTitle = '';\n    this.patientFields = ['first name', 'last name', 'personal id', 'phone number', 'email', 'medical conditions', 'surgical history', 'medications', 'allergies', 'immunizations', `doctor's name`, `doctor's surname`];\n  }\n  registerPatient() {\n    const patient = {\n      firstName: this.registerPatientForm.get('first name')?.value,\n      lastName: this.registerPatientForm.get('last name')?.value,\n      personalId: this.registerPatientForm.get('personal id')?.value,\n      dateOfBirth: this.registerPatientForm.get('date of birth')?.value,\n      phoneNumber: this.registerPatientForm.get('phone number')?.value,\n      email: this.registerPatientForm.get('email')?.value,\n      medicalConditions: this.registerPatientForm.get('medical conditions')?.value,\n      surgicalHistory: this.registerPatientForm.get('surgical history')?.value,\n      medications: this.registerPatientForm.get('medications')?.value,\n      allergies: this.registerPatientForm.get('allergies')?.value,\n      immunizations: this.registerPatientForm.get('immunizations')?.value,\n      doctorsName: this.registerPatientForm.get(`doctor's name`)?.value,\n      doctorsSurname: this.registerPatientForm.get(`doctor's surname`)?.value,\n      insurance: this.registerPatientForm.get('insurance')?.value\n    };\n    if (this.registerPatientForm.valid) {\n      if (this.registerOrEdit === 'Register') {\n        this.patientsService.addNewPatient(patient).subscribe({\n          next: () => {\n            this.patientEdited.emit(true);\n            this.resetForm();\n            this.close();\n          },\n          error: error => {\n            console.error('Error registering patient:', error);\n          }\n        });\n      } else if (this.registerOrEdit === 'Edit') {\n        patient.id = this.patient?.id;\n        this.patientsService.editPatient(patient.id, patient).subscribe({\n          next: () => {\n            this.patientEdited.emit(true);\n            this.resetForm();\n            this.patient = undefined;\n            this.close();\n          },\n          error: error => {\n            console.error('Error editing patient:', error);\n          }\n        });\n      }\n    } else {\n      alert('Please fill in all the required fields.');\n    }\n  }\n}\nRegistrationFormComponent.ɵfac = function RegistrationFormComponent_Factory(t) {\n  return new (t || RegistrationFormComponent)(i0.ɵɵdirectiveInject(i1.PatientsService), i0.ɵɵdirectiveInject(i2.FormBuilder));\n};\nRegistrationFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RegistrationFormComponent,\n  selectors: [[\"app-registration-form\"]],\n  inputs: {\n    isModalOpen: \"isModalOpen\",\n    patient: \"patient\"\n  },\n  outputs: {\n    isModalOpenChange: \"isModalOpenChange\",\n    patientEdited: \"patientEdited\"\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 1,\n  vars: 1,\n  consts: [[\"class\", \"overlay\", 3, \"click\", 4, \"ngIf\"], [1, \"overlay\", 3, \"click\"], [1, \"app__modal\", 3, \"click\"], [1, \"mb-3\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"fields\"], [\"class\", \"form-group\", 4, \"ngFor\", \"ngForOf\"], [1, \"form-group\"], [\"for\", \"date of birth\"], [\"type\", \"date\", \"id\", \"date of birth\", 1, \"form-control\", 3, \"formControlName\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [1, \"form-group\", \"d-flex\", \"flex-column\"], [\"for\", \"insurance\", 1, \"form-check-label\"], [\"type\", \"checkbox\", \"id\", \"insurance\", 1, \"form-check-input\", \"checkbox\", 3, \"formControlName\"], [1, \"d-flex\", \"gap-3\", \"mt-3\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [3, \"for\"], [\"type\", \"text\", 1, \"form-control\", 3, \"id\", \"formControlName\", \"placeholder\"], [1, \"text-danger\"]],\n  template: function RegistrationFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, RegistrationFormComponent_div_0_Template, 21, 7, \"div\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.isModalOpen);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.CheckboxControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n  styles: [\".form-group[_ngcontent-%COMP%] {\\n  flex: 1;\\n  margin-right: 10px; \\n  min-width: 240px;\\n}\\n\\n.fields[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-wrap: wrap;\\n}\\n\\n.checkbox[_ngcontent-%COMP%] {\\n  height: 30px;\\n  width: 30px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9yZWdpc3RyYXRpb24tZm9ybS9yZWdpc3RyYXRpb24tZm9ybS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLE9BQUE7RUFDQSxrQkFBQSxFQUFBLGlDQUFBO0VBQ0EsZ0JBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxlQUFBO0FBQ0Y7O0FBRUE7RUFDRSxZQUFBO0VBQ0EsV0FBQTtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLmZvcm0tZ3JvdXAge1xuICBmbGV4OiAxO1xuICBtYXJnaW4tcmlnaHQ6IDEwcHg7IC8qIEFkanVzdCB0aGUgc3BhY2luZyBhcyBuZWVkZWQgKi9cbiAgbWluLXdpZHRoOiAyNDBweDtcbn1cblxuLmZpZWxkc3tcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC13cmFwOiB3cmFwO1xufVxuXG4uY2hlY2tib3gge1xuICBoZWlnaHQ6IDMwcHg7XG4gIHdpZHRoOiAzMHB4O1xufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["EventEmitter","Validators","i0","RegistrationFormComponent","personalIdValidator","control","personalId","value","regex","test","invalidPersonalId","buidForm","registerPatientForm","fb","group","required","pattern","V","email","medications","allergies","immunizations","insurance","populateForm","patient","patchValue","firstName","lastName","dateOfBirth","phoneNumber","medicalConditions","surgicalHistory","doctorsName","doctorsSurname","ngOnChanges","changes","isModalOpen","registerOrEdit","formTitle","ngOnInit","close","resetForm","isModalOpenChange","emit","preventClose","event","stopPropagation","reset","constructor","patientsService","registerPatient","get","valid","addNewPatient","subscribe","next","patientEdited","error","console","id","editPatient","undefined","alert","selectors","inputs","outputs","features","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\User\\Desktop\\repharm-patients\\ClientApp\\src\\app\\components\\registration-form\\registration-form.component.ts","C:\\Users\\User\\Desktop\\repharm-patients\\ClientApp\\src\\app\\components\\registration-form\\registration-form.component.html"],"sourcesContent":["import {\n  Component,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  SimpleChanges,\n} from '@angular/core';\nimport {\n  AbstractControl,\n  FormBuilder,\n  FormGroup,\n  ValidatorFn,\n  Validators,\n} from '@angular/forms';\nimport { Patient } from 'src/app/models/patient.model';\nimport { PatientsService } from 'src/app/services/patients.service';\n\n@Component({\n  selector: 'app-registration-form',\n  templateUrl: './registration-form.component.html',\n  styleUrls: ['./registration-form.component.scss'],\n})\nexport class RegistrationFormComponent implements OnInit {\n  @Input() isModalOpen: boolean = false;\n  @Input() patient?: Partial<Patient>;\n  @Output() isModalOpenChange = new EventEmitter<boolean>();\n  @Output() patientEdited = new EventEmitter<boolean>();\n\n  registerPatientForm: FormGroup = this.fb.group({});\n  registerOrEdit: 'Register' | 'Edit' = 'Register';\n  formTitle: string = '';\n\n  personalIdValidator(): ValidatorFn {\n    return (control: AbstractControl): { [key: string]: any } | null => {\n      const personalId = control.value;\n      if (!personalId) {\n        return null;\n      }\n\n      const regex = /^\\d{6}-\\d{5}$/;\n      if (!regex.test(personalId)) {\n        return { invalidPersonalId: true };\n      }\n\n      return null;\n    };\n  }\n\n  buidForm(): void {\n    this.registerPatientForm = this.fb.group({\n      'first name': ['', Validators.required],\n      'last name': ['', Validators.required],\n      'personal id': ['', [Validators.required, this.personalIdValidator()]],\n      'date of birth': [\n        '',\n        [Validators.required, Validators.pattern(/^\\d{4}-\\d{2}-\\d{2}$/)],\n      ],\n      'phone number': ['', Validators.required, V],\n      email: ['', [Validators.required, Validators.email]],\n      'medical conditions': [''],\n      'surgical history': [''],\n      medications: [''],\n      allergies: [''],\n      immunizations: [''],\n      \"doctor's name\": ['', Validators.required],\n      \"doctor's surname\": ['', Validators.required],\n      insurance: [false],\n    });\n  }\n  populateForm(): void {\n    if (this.patient) {\n      this.registerPatientForm.patchValue({\n        'first name': this.patient.firstName,\n        'last name': this.patient.lastName,\n        'personal id': this.patient.personalId,\n        'date of birth': this.patient.dateOfBirth,\n        'phone number': this.patient.phoneNumber,\n        email: this.patient.email,\n        'medical conditions': this.patient.medicalConditions,\n        'surgical history': this.patient.surgicalHistory,\n        medications: this.patient.medications,\n        allergies: this.patient.allergies,\n        immunizations: this.patient.immunizations,\n        \"doctor's name\": this.patient.doctorsName,\n        \"doctor's surname\": this.patient.doctorsSurname,\n        insurance: this.patient.insurance,\n      });\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.isModalOpen && this.isModalOpen) {\n      if (this.patient) {\n        this.populateForm();\n        this.registerOrEdit = 'Edit';\n        this.formTitle = \"Change Patient's data\";\n      } else {\n        this.registerOrEdit = 'Register';\n        this.formTitle = 'Register New Patient';\n        this.buidForm();\n      }\n    }\n  }\n\n  ngOnInit(): void {\n    this.buidForm();\n  }\n\n  patientFields: string[] = [\n    'first name',\n    'last name',\n    'personal id',\n    'phone number',\n    'email',\n    'medical conditions',\n    'surgical history',\n    'medications',\n    'allergies',\n    'immunizations',\n    `doctor's name`,\n    `doctor's surname`,\n  ];\n\n  close() {\n    this.resetForm();\n    this.isModalOpenChange.emit(false);\n  }\n\n  preventClose(event: Event) {\n    event.stopPropagation();\n  }\n\n  private resetForm() {\n    this.registerPatientForm.reset();\n  }\n\n  constructor(\n    private patientsService: PatientsService,\n    private fb: FormBuilder\n  ) {}\n\n  registerPatient() {\n    const patient: Partial<Patient> = {\n      firstName: this.registerPatientForm.get('first name')?.value,\n      lastName: this.registerPatientForm.get('last name')?.value,\n      personalId: this.registerPatientForm.get('personal id')?.value,\n      dateOfBirth: this.registerPatientForm.get('date of birth')?.value,\n      phoneNumber: this.registerPatientForm.get('phone number')?.value,\n      email: this.registerPatientForm.get('email')?.value,\n      medicalConditions:\n        this.registerPatientForm.get('medical conditions')?.value,\n      surgicalHistory: this.registerPatientForm.get('surgical history')?.value,\n      medications: this.registerPatientForm.get('medications')?.value,\n      allergies: this.registerPatientForm.get('allergies')?.value,\n      immunizations: this.registerPatientForm.get('immunizations')?.value,\n      doctorsName: this.registerPatientForm.get(`doctor's name`)?.value,\n      doctorsSurname: this.registerPatientForm.get(`doctor's surname`)?.value,\n      insurance: this.registerPatientForm.get('insurance')?.value,\n    };\n    if (this.registerPatientForm.valid) {\n      if (this.registerOrEdit === 'Register') {\n        this.patientsService.addNewPatient(patient).subscribe({\n          next: () => {\n            this.patientEdited.emit(true);\n            this.resetForm();\n            this.close();\n          },\n          error: (error) => {\n            console.error('Error registering patient:', error);\n          },\n        });\n      } else if (this.registerOrEdit === 'Edit') {\n        patient.id = this.patient?.id;\n        this.patientsService.editPatient(patient.id, patient).subscribe({\n          next: () => {\n            this.patientEdited.emit(true);\n            this.resetForm();\n            this.patient = undefined;\n            this.close();\n          },\n          error: (error) => {\n            console.error('Error editing patient:', error);\n          },\n        });\n      }\n    } else {\n      alert('Please fill in all the required fields.');\n    }\n  }\n}\n","<div (click)=\"close()\" class=\"overlay\" *ngIf=\"isModalOpen\">\n  <div class=\"app__modal\" (click)=\"preventClose($event)\">\n    <h2 class=\"mb-3\">{{ formTitle }}</h2>\n    <form [formGroup]=\"registerPatientForm\" (ngSubmit)=\"registerPatient()\">\n      <div class=\"fields\">\n        <div *ngFor=\"let field of patientFields\" class=\"form-group\">\n          <label [for]=\"field\">{{ field }}</label>\n          <input\n            type=\"text\"\n            [id]=\"field\"\n            [formControlName]=\"field\"\n            class=\"form-control\"\n            [placeholder]=\"field === 'date of birth' ? 'DD.MM.YYYY' : ''\"\n          />\n          <small\n            *ngIf=\"\n              registerPatientForm.get(field)?.hasError('required') &&\n              registerPatientForm.get(field)?.touched\n            \"\n            class=\"text-danger\"\n          >\n            This field is required.\n          </small>\n        </div>\n        <!-- Date of Birth input-->\n        <div class=\"form-group\">\n          <label for=\"date of birth\">Date of Birth</label>\n          <input\n            type=\"date\"\n            id=\"date of birth\"\n            [formControlName]=\"'date of birth'\"\n            class=\"form-control\"\n          />\n          <small\n            *ngIf=\"\n              registerPatientForm.get('date of birth')?.hasError('required') &&\n              registerPatientForm.get('date of birth')?.touched\n            \"\n            class=\"text-danger\"\n          >\n            This field is required.\n          </small>\n        </div>\n        <!-- Insurance input-->\n        <div class=\"form-group d-flex flex-column\">\n          <label for=\"insurance\" class=\"form-check-label\">Insurance</label>\n          <input\n            type=\"checkbox\"\n            id=\"insurance\"\n            [formControlName]=\"'insurance'\"\n            class=\"form-check-input checkbox\"\n          />\n        </div>\n      </div>\n      <div class=\"d-flex gap-3 mt-3\">\n        <button (click)=\"close()\" type=\"button\" class=\"btn btn-danger\">\n          Close\n        </button>\n        <button type=\"submit\" class=\"btn btn-primary\">\n          {{ registerOrEdit }}\n        </button>\n      </div>\n    </form>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}